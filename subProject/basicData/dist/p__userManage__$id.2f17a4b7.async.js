(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[14],{"+waW":function(e,a,t){"use strict";t.r(a);t("YdMF");var n=t("dVZ9"),r=(t("zI7Q"),t("SCaQ")),s=(t("53cK"),t("VKn7")),l=(t("mZxn"),t("S7b9")),c=(t("rkcQ"),t("Mob5")),u=t("JCfe"),i=t.n(u),o=(t("DoiJ"),t("9xBf")),p=(t("oeo2"),t("BmDy")),m=t("Z32k"),d=t.n(m),f=t("JGaj"),b=t.n(f),h=(t("vgpD"),t("UL5a")),g=t("maMK"),w=t.n(g),E=t("YBJ6"),v=t.n(E),y=(t("ljfu"),t("x2dm")),k=t("mTBN"),x=t("ERkP"),j=t.n(x),O=t("st+D"),I=t("li0l"),C=t("MNWE"),S=(t("FEDD"),t("4ca3")),_=t("OZ92"),M=t("1Pzi"),F=y["a"].Option,z={labelCol:{span:6},wrapperCol:{span:18}},D={wrapperCol:{offset:10,span:4}},N=["\u8bf7\u8f93\u5165\u8d26\u53f7","\u8f93\u5165\u7684\u8d26\u53f7\u6700\u77ed4\u4e2a\u5b57\u7b26","\u8f93\u5165\u7684\u8d26\u53f7\u6700\u957f12\u4e2a\u5b57\u7b26","\u8f93\u5165\u7684\u8d26\u53f7\u4e0d\u80fd\u6709\u7a7a\u683c","\u8f93\u5165\u7684\u8d26\u53f7\u5fc5\u987b\u7531\u5b57\u6bcd\u3001\u6570\u5b57\u4e0e\u4e0b\u5212\u7ebf\u7ec4\u6210","\u8f93\u5165\u7684\u8d26\u53f7\u5df2\u5b58\u5728"],J=["\u8bf7\u8f93\u5165\u5bc6\u7801","\u8f93\u5165\u7684\u5bc6\u7801\u6700\u5c116\u4e2a\u5b57\u7b26","\u8f93\u5165\u7684\u5bc6\u7801\u6700\u591a18\u4e2a\u5b57\u7b26","\u8f93\u5165\u7684\u5bc6\u7801\u4e0d\u80fd\u6709\u7a7a\u683c","\u8f93\u5165\u7684\u5bc6\u7801\u5fc5\u987b\u7531\u5b57\u6bcd\u3001\u6570\u5b57\u4e0e\u4e0b\u5212\u7ebf\u7ec4\u6210"],P=["\u8bf7\u9009\u62e9\u81f3\u5c11\u4e00\u4e2a\u6743\u9650\u7ec4"],q=["\u8bf7\u9009\u62e9\u4f7f\u7528\u4eba"],B=function(e,a){return Object.assign(e,v()({},a.type,a.value))},V=function(e){var a=Object(x["useState"])(!0),t=w()(a,2),u=t[0],m=t[1],f=Object(x["useState"])(-1),g=w()(f,2),E=g[0],v=g[1],k=Object(x["useState"])(-1),V=w()(k,2),K=V[0],Z=V[1],A=Object(x["useState"])(-1),Q=w()(A,2),T=Q[0],G=Q[1],L=Object(x["useState"])(-1),R=w()(L,2),W=R[0],Y=R[1],$=Object(x["useState"])([]),U=w()($,2),H=U[0],X=(U[1],Object(x["useState"])(!1)),ee=w()(X,2),ae=(ee[0],ee[1]),te=Object(x["useState"])({}),ne=w()(te,2),re=ne[0],se=(ne[1],Object(x["useState"])(!1)),le=w()(se,2),ce=le[0],ue=le[1],ie=Object(x["useState"])(Object(I["a"])("type")?Object(I["a"])("type"):"read"),oe=w()(ie,2),pe=oe[0],me=oe[1],de=Object(M["f"])("user"),fe=Object(x["useReducer"])(B,{name:"",password:"",userId:"",userName:"",permissionIds:[],permissionNames:[],status:""}),be=w()(fe,2),he=be[0],ge=be[1],we=h["a"].useForm(),Ee=w()(we,1),ve=Ee[0];Object(x["useEffect"])(function(){ke()},[]);var ye=[{title:"\u4f7f\u7528\u4eba",dataIndex:"name"},{title:"\u624b\u673a",dataIndex:"mobile"},{title:"\u90e8\u95e8",dataIndex:"departments",render:function(e){return e&&e.length>0?e.map(function(e){return e.name}).join(","):""}},{title:"\u804c\u52a1",dataIndex:"title",render:function(e){return e&&e.name?e.name:""}}],ke=function(){var a=b()(d.a.mark(function a(){var t;return d.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:t=e.match.params.id.replace(":",""),"new"!==t?m(!1):(ge({type:"status",value:1}),ve.setFieldsValue({status:1}));case 2:case"end":return a.stop()}},a)}));return function(){return a.apply(this,arguments)}}(),xe=function(){var e=b()(d.a.mark(function e(a){var t;return d.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(S["f"])({username_icontains:a,no_page:!0});case 2:return t=e.sent,e.abrupt("return",!!(t&&Object(C["a"])(t,"results")&&"[object Array]"===Object.prototype.toString.call(t.results)&&t.results.length>0));case 4:case"end":return e.stop()}},e)}));return function(a){return e.apply(this,arguments)}}(),je=function(){var e=b()(d.a.mark(function e(a){var t,n;return d.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(m(!1),t=-1,0!==a.length){e.next=7;break}t=0,v(t),e.next=31;break;case 7:if(!(a.length<4)){e.next=12;break}t=1,v(t),e.next=31;break;case 12:if(!(a.length>12)){e.next=17;break}t=2,v(t),e.next=31;break;case 17:if(!(a.split(" ").length>1)){e.next=22;break}t=3,v(t),e.next=31;break;case 22:if(/^[0-9a-zA-z]{4,12}$/.test(a)){e.next=27;break}t=4,v(t),e.next=31;break;case 27:return e.next=29,xe(a);case 29:n=e.sent,n?v(5):(v(-1),ge({type:"name",value:a}));case 31:case"end":return e.stop()}},e)}));return function(a){return e.apply(this,arguments)}}(),Oe=function(){var e=b()(d.a.mark(function e(a){var t;return d.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:m(!1),t=-1,0===a.length?(t=0,Z(t)):a.length<6?(t=1,Z(t)):a.length>18?(t=2,Z(t)):a.split(" ").length>1?(t=3,Z(t)):/^[0-9a-zA-z]{4,12}$/.test(a)?(Z(-1),ge({type:"password",value:a})):(t=4,Z(t));case 3:case"end":return e.stop()}},e)}));return function(a){return e.apply(this,arguments)}}(),Ie=function(){var e=b()(d.a.mark(function e(a){return d.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:ge({type:"permissionIds",value:a});case 1:case"end":return e.stop()}},e)}));return function(a){return e.apply(this,arguments)}}(),Ce=function(e,a){return"add"===e?j.a.createElement(h["a"].Item,{name:"password",className:"form-item__under-multiple-form-item",rules:[{required:!0,message:J[0]}],validateStatus:-1===K?"":"error",help:J[K]},j.a.createElement(p["a"].Password,{onChange:function(e){return Oe(e.target.value)},value:he.password})):"edit"===e?j.a.createElement(j.a.Fragment,null,j.a.createElement(h["a"].Item,{name:"password",className:"form-item__with-a-href-behind",style:{display:a?"block":"none"},rules:[{required:a,message:J[0]}],validateStatus:-1===K?"":"error",help:J[K]},j.a.createElement(p["a"].Password,{onChange:function(e){return Oe(e.target.value)},value:he.password})),j.a.createElement(o["a"],{title:""},j.a.createElement("a",{style:a?{float:"left",marginLeft:"87.5%",marginTop:"-25px"}:{},onClick:function(e){e.preventDefault(),ue(!a)}},a?"\u53d6\u6d88\u91cd\u7f6e":"\u91cd\u7f6e\u5bc6\u7801"))):null},Se=function(e,a){return"password"===a?"edit"===e?15:"add"===e?12:0:"edit"===e?9:"add"===e?12:0},_e=function(){var a=b()(d.a.mark(function a(t){var n,r,s,l,o,p,m,f;return d.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:if(n=ve.getFieldsError(Object.keys(t)),r=n.map(function(e){return e.errors}).flat(1),"add"===pe&&""===he.userId&&(G(0),r.push(q[0])),0===he.permissionIds.length&&(Y(0),r.push(P[0])),u||-1!==E||-1!==K||-1!==W||-1!==T||0!==r.length){a.next=29;break}if(s={username:t.name,userprofile:{person_id:re.id,is_enabled:Boolean(he.status)}},t.password&&(s.password=t.password),l=e.match.params.id.replace(":",""),"new"===l){a.next=15;break}return delete s.userprofile.person_id,a.next=12,Object(S["g"])({params:s,id:l});case 12:s=a.sent,a.next=18;break;case 15:return a.next=17,Object(S["i"])(i()({},s));case 17:s=a.sent;case 18:if(!s||!s.id){a.next=27;break}if(o=he.permissionIds,m=Object(S["k"])({id:s.id,param:{groups:o}}),!ce){a.next=25;break}return a.next=24,Object(S["h"])({id:s.id,param:{password:he.password}});case 24:p=a.sent;case 25:f=!ce||p,m&&f&&(c["a"].success({message:"\u4fdd\u5b58\u8d26\u6237\u4fe1\u606f\u6210\u529f"}),O["router"].push("/systemManage/userManage/"));case 27:a.next=30;break;case 29:ve.validateFields();case 30:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}(),Me=Object(_["a"])({title:"\u7528\u6237\u7ba1\u7406",buttonGroups:[],back:"/systemManage/userManage/"});return j.a.createElement(j.a.Fragment,null,Me,j.a.createElement("div",{className:"content content_margin-10 content-container_background-color content-container_padding-around-top-more"},j.a.createElement(h["a"],Object.assign({},z,{form:ve,name:"basic",initialValues:he}),j.a.createElement(l["a"],{gutter:10},j.a.createElement(s["a"],{span:12},j.a.createElement(h["a"].Item,{label:"\u8d26\u6237",name:"name",rules:[{required:!0,message:N[0]}],validateStatus:-1===E?"":"error",help:N[E]},j.a.createElement(p["a"],{disabled:"add"!==pe,onChange:function(e){return je(e.target.value)},value:he.name}))),j.a.createElement(s["a"],{span:12}),j.a.createElement(s["a"],{span:Se(pe,"password")},j.a.createElement(h["a"].Item,{label:"\u5bc6\u7801",labelCol:{span:"edit"===pe?4:6},wrapperCol:{span:"edit"===pe?14:18},style:{width:"edit"===pe?"120%":"100%"}},"read"===pe?j.a.createElement("span",null,he.password):Ce(pe,ce))),j.a.createElement(s["a"],{span:Se(pe,"")}),j.a.createElement(s["a"],{span:12},j.a.createElement(h["a"].Item,{label:"\u72b6\u6001",name:"status"},j.a.createElement(y["a"],{disabled:"add"!==pe,onChange:function(e){return ge({type:"status",value:e})},value:he.status},j.a.createElement(F,{key:1,value:1},"\u542f\u7528"),j.a.createElement(F,{key:0,value:0},"\u505c\u7528")))),j.a.createElement(s["a"],{span:12}),j.a.createElement(s["a"],{span:12},j.a.createElement(h["a"].Item,{label:"\u6743\u9650\u7ec4",name:"permissionIds",rules:[{required:!0,message:P[0]}],validateStatus:-1===W?"":"error",help:P[W]},j.a.createElement(y["a"],{mode:"multiple",disabled:"read"===pe,style:{width:"100%"},placeholder:"\u8bf7\u9009\u62e9\u6743\u9650\u7ec4",defaultValue:he.permissionIds,onChange:function(e){return Ie(e)}},H.length>0&&H.map(function(e){return j.a.createElement(F,{key:e.id,value:e.id},e.name)})))),j.a.createElement(s["a"],{span:12}),j.a.createElement(s["a"],{span:24},j.a.createElement(h["a"].Item,{label:"\u4f7f\u7528\u4eba",name:"userIds",labelCol:{span:3},wrapperCol:{span:21},rules:[{required:"add"===pe,message:q[0]}],validateStatus:-1===T?"":"error",help:q[T]},j.a.createElement(r["a"],{type:"primary",style:{display:"add"===pe?"":"none"},onClick:function(){return ae(!0)}},"\u8bf7\u9009\u62e9\u4f7f\u7528\u4eba"),j.a.createElement(n["a"],{bordered:!1,rowKey:function(e){return e.id},columns:ye,dataSource:[re],pagination:!1,size:"small",style:{display:Object.keys(re).length>0?"block":"none",marginTop:15}})))),Object(M["e"])(de,"system-manage:write")?j.a.createElement(h["a"].Item,Object.assign({},D),"read"===pe?j.a.createElement(l["a"],null,j.a.createElement(s["a"],{span:24},j.a.createElement(r["a"],{type:"primary",onClick:function(){me("edit"),O["router"].push("".concat(e.route.path.split(":")[0],":").concat(e.match.params.id.replace(":",""),"?type=edit"))}},"\u7f16\u8f91"))):j.a.createElement(l["a"],{gutter:15},j.a.createElement(s["a"],{span:12},j.a.createElement(r["a"],{onClick:function(){return O["router"].push("/systemManage/userManage/")}},"\u53d6\u6d88")),j.a.createElement(s["a"],{span:12},j.a.createElement(r["a"],{type:"primary",onClick:function(){return _e(he)}},"\u4fdd\u5b58")))):null)))};a["default"]=Object(k["connect"])(function(e){var a=e.siderMenus;return{menuPermission:a.menuPermission}})(V)}}]);